<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>TommyDS</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="tommy.css" rel="stylesheet" type="text/css">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21967501-2']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body>
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Tommy </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p >Tommy is a C library of array, <b>hashtable</b> and trie data structures, designed for high performance and providing an easy-to-use interface.</p>
<p >It's <b>faster</b> than all the similar libraries like <a href="http://www.canonware.com/rb/">rbtree</a>, <a href="http://www.nedprod.com/programs/portable/nedtries/">nedtrie</a>, <a href="https://github.com/attractivechaos/klib/blob/master/khash.h">khash</a>, <a href="http://uthash.sourceforge.net/">uthash</a>, <a href="http://judy.sourceforge.net/">judy</a>, <a href="https://code.google.com/archive/p/judyarray/">judyarray</a>, <a href="https://github.com/sparsehash/sparsehash">googledensehash</a>, <a href="http://code.google.com/p/cpp-btree/">googlebtree</a>, <a href="http://panthema.net/2007/stx-btree/">stxbtree</a>, <a href="https://sites.google.com/site/binarysearchcube/">tesseract</a>, <a href="https://github.com/fredrikwidlund/libdynamic">libdynamic</a>, <a href="http://concurrencykit.org/">concurrencykit</a> and others.</p>
<p >The data structures provided are:</p>
<ul>
<li><a class="el" href="tommylist_8h.html#a45d098412d5f0be21113b252caee491b" title="Doubly linked list type.">tommy_list</a> - A double linked list.</li>
<li><a class="el" href="tommyarray_8h.html#af99015836dd926c7f27057d7a460e40c" title="Array container type.">tommy_array</a>, <a class="el" href="tommyarrayof_8h.html#ae551bd8a6fc9added36973ac14d86611" title="Array container type.">tommy_arrayof</a> - A linear array. It doesn't fragment the heap.</li>
<li><a class="el" href="tommyarrayblk_8h.html#a4b6a0d0d6fd1edf7460a7df0d87493de" title="Array container type.">tommy_arrayblk</a>, <a class="el" href="tommyarrayblkof_8h.html#adfdd54d1a248125b6b64149b9069e06b" title="Array container type.">tommy_arrayblkof</a> - A blocked linear array. It doesn't fragment the heap and it minimizes space occupation.</li>
<li><a class="el" href="tommyhashtbl_8h.html#aa4d9626d450b1a0da8a5838a7177c4b1" title="Hashtable container type.">tommy_hashtable</a> - A fixed-size chained hashtable.</li>
<li><a class="el" href="tommyhashdyn_8h.html#ae3b3e52313d2da8e872e890e8185205b" title="Hashtable container type.">tommy_hashdyn</a> - A dynamic chained hashtable.</li>
<li><a class="el" href="tommyhashlin_8h.html#a1f83949c28fe369e100d2e44911c04c5" title="Hashtable container type.">tommy_hashlin</a> - A linear chained hashtable. It doesn't have the problem of the delay when resizing and it doesn't fragment the heap.</li>
<li><a class="el" href="tommytrie_8h.html#a3a77169f497c9ab7b03d80cf456a08e4" title="Trie container type.">tommy_trie</a> - A trie optimized for cache utilization.</li>
<li><a class="el" href="tommytrieinp_8h.html#aa2db3b1aa9bfc7cfc87c19aa9777634e" title="Trie container type.">tommy_trie_inplace</a> - A trie completely inplace.</li>
<li><a class="el" href="tommytree_8h.html#a6d5d8b00c2e0c21372d490be7e59cc46" title="Tree container type.">tommy_tree</a> - A tree to keep elements in order.</li>
</ul>
<p >The most interesting are <a class="el" href="tommyarray_8h.html#af99015836dd926c7f27057d7a460e40c" title="Array container type.">tommy_array</a>, <a class="el" href="tommyhashdyn_8h.html#ae3b3e52313d2da8e872e890e8185205b" title="Hashtable container type.">tommy_hashdyn</a>, <a class="el" href="tommyhashlin_8h.html#a1f83949c28fe369e100d2e44911c04c5" title="Hashtable container type.">tommy_hashlin</a>, <a class="el" href="tommytrie_8h.html#a3a77169f497c9ab7b03d80cf456a08e4" title="Trie container type.">tommy_trie</a> and <a class="el" href="tommytrieinp_8h.html#aa2db3b1aa9bfc7cfc87c19aa9777634e" title="Trie container type.">tommy_trie_inplace</a>.</p>
<p >The official site of TommyDS is <a href="https://www.tommyds.it/">https://www.tommyds.it/</a>.</p>
<h1><a class="anchor" id="Use"></a>
Use</h1>
<p >All the Tommy containers are used to store pointers to generic objects, associated with an integer value, that could be a key or a hash value.</p>
<p >They are semantically equivalent to the C++ <a href="http://www.cplusplus.com/reference/map/multimap/">multimap&lt;unsigned,void*&gt;</a> and <a href="http://www.cplusplus.com/reference/unordered_map/unordered_multimap/">unordered_multimap&lt;unsigned,void*&gt;</a>.</p>
<p >An object, to be inserted into a container, should contain a node of type <a class="el" href="tommytypes_8h.html#a1e8ddf0d3a75d9c875f08324c0d98628" title="Data structure node.">tommy_node</a>. Inside this node is present a pointer to the object itself in the <a class="el" href="structtommy__node__struct.html#a6210792ec52fa1efbfb44cf4557d9b6f" title="Pointer to the object containing the node.">tommy_node::data</a> field, the key used to identify the object in the tommy_node::key field, and other fields used by the containers.</p>
<p >This is a typical object declaration: </p><div class="fragment"><div class="line"><span class="keyword">struct </span>object {</div>
<div class="line">    <span class="comment">// other fields</span></div>
<div class="line">    <a class="code hl_struct" href="structtommy__node__struct.html">tommy_node</a> node;</div>
<div class="line">};</div>
<div class="ttc" id="astructtommy__node__struct_html"><div class="ttname"><a href="structtommy__node__struct.html">tommy_node_struct</a></div><div class="ttdoc">Data structure node.</div><div class="ttdef"><b>Definition:</b> tommytypes.h:211</div></div>
</div><!-- fragment --><p >To insert an object into a container, you have to provide the address of the embedded node, the address of the object and the value of the key. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> key_to_insert = 1;</div>
<div class="line"><span class="keyword">struct </span>object* obj = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <span class="keywordtype">object</span>));</div>
<div class="line">...</div>
<div class="line">tommy_trie_insert(..., &amp;obj-&gt;node, obj, key_to_insert);</div>
</div><!-- fragment --><p >To search for an object you have to provide the key and call the search function. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> key_to_find = 1;</div>
<div class="line"><span class="keyword">struct </span>object* obj = <a class="code hl_function" href="tommytrie_8h.html#a83774ac7328017d6935fc88c3879fb23">tommy_trie_search</a>(..., key_to_find);</div>
<div class="line"><span class="keywordflow">if</span> (obj) {</div>
<div class="line">    <span class="comment">// found</span></div>
<div class="line">}</div>
<div class="ttc" id="atommytrie_8h_html_a83774ac7328017d6935fc88c3879fb23"><div class="ttname"><a href="tommytrie_8h.html#a83774ac7328017d6935fc88c3879fb23">tommy_trie_search</a></div><div class="ttdeci">void * tommy_trie_search(tommy_trie *trie, tommy_key_t key)</div><div class="ttdoc">Searches an element in the trie.</div><div class="ttdef"><b>Definition:</b> tommytrie.h:238</div></div>
</div><!-- fragment --><p >To access all the objects with the same key, you have to iterate over the bucket assigned at the specified key. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> key_to_find = 1;</div>
<div class="line"><a class="code hl_struct" href="structtommy__node__struct.html">tommy_trie_node</a>* i = <a class="code hl_function" href="tommytrie_8h.html#ab6caed60ebeff23b82fe1b536852688a">tommy_trie_bucket</a>(..., key_to_find);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (i) {</div>
<div class="line">    <span class="keyword">struct </span>object* obj = i-&gt;<a class="code hl_variable" href="structtommy__node__struct.html#a6210792ec52fa1efbfb44cf4557d9b6f">data</a>; <span class="comment">// gets the object pointer</span></div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;%d\n&quot;</span>, obj-&gt;value); <span class="comment">// process the object</span></div>
<div class="line"> </div>
<div class="line">    i = i-&gt;<a class="code hl_variable" href="structtommy__node__struct.html#a53338f3f5366866598ed9ac7e46e64a2">next</a>; <span class="comment">// goes to the next element</span></div>
<div class="line">}</div>
<div class="ttc" id="astructtommy__node__struct_html_a53338f3f5366866598ed9ac7e46e64a2"><div class="ttname"><a href="structtommy__node__struct.html#a53338f3f5366866598ed9ac7e46e64a2">tommy_node_struct::next</a></div><div class="ttdeci">struct tommy_node_struct * next</div><div class="ttdoc">Next node.</div><div class="ttdef"><b>Definition:</b> tommytypes.h:216</div></div>
<div class="ttc" id="astructtommy__node__struct_html_a6210792ec52fa1efbfb44cf4557d9b6f"><div class="ttname"><a href="structtommy__node__struct.html#a6210792ec52fa1efbfb44cf4557d9b6f">tommy_node_struct::data</a></div><div class="ttdeci">void * data</div><div class="ttdoc">Pointer to the object containing the node.</div><div class="ttdef"><b>Definition:</b> tommytypes.h:228</div></div>
<div class="ttc" id="atommytrie_8h_html_ab6caed60ebeff23b82fe1b536852688a"><div class="ttname"><a href="tommytrie_8h.html#ab6caed60ebeff23b82fe1b536852688a">tommy_trie_bucket</a></div><div class="ttdeci">TOMMY_API tommy_trie_node * tommy_trie_bucket(tommy_trie *trie, tommy_key_t key)</div><div class="ttdoc">Gets the bucket of the specified key.</div></div>
</div><!-- fragment --><p >To remove an object you have to provide the key and call the remove function. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> key_to_remove = 1;</div>
<div class="line"><span class="keyword">struct </span>object* obj = <a class="code hl_function" href="tommytrie_8h.html#a2a68f3e28cf8e964cdd94964bde131a8">tommy_trie_remove</a>(..., key_to_remove);</div>
<div class="line"><span class="keywordflow">if</span> (obj) {</div>
<div class="line">    <span class="comment">// found</span></div>
<div class="line">    free(obj); <span class="comment">// frees the allocated object memory</span></div>
<div class="line">}</div>
<div class="ttc" id="atommytrie_8h_html_a2a68f3e28cf8e964cdd94964bde131a8"><div class="ttname"><a href="tommytrie_8h.html#a2a68f3e28cf8e964cdd94964bde131a8">tommy_trie_remove</a></div><div class="ttdeci">TOMMY_API void * tommy_trie_remove(tommy_trie *trie, tommy_key_t key)</div><div class="ttdoc">Searches and removes the first element with the specified key.</div></div>
</div><!-- fragment --><p >Dealing with hashtables, instead of the key, you have to provide the hash value of the object, and a compare function able to differentiate objects with the same hash value. To compute the hash value, you can use the generic <a class="el" href="tommyhash_8h.html#a830690d0c1220b6fcd8f80e2fdf949b9" title="Hash function with a 32 bits result.">tommy_hash_u32()</a> function, or the specialized integer hash function <a class="el" href="tommyhash_8h.html#aea9c8438064a941d13e6f5462b5bff71" title="Integer reversible hash function for 32 bits.">tommy_inthash_u32()</a>.</p>
<h1><a class="anchor" id="Features"></a>
Features</h1>
<p >Tommy is fast and easy to use.</p>
<p >Tommy is portable to all platforms and operating systems.</p>
<p >Tommy containers support multiple elements with the same key.</p>
<p >Tommy containers keep the original insertion order of elements with equal keys.</p>
<p >Tommy is released with the <a class="el" href="license.html">2-clause BSD license</a>.</p>
<p >See the <a class="el" href="design.html">Tommy Design</a> page for more details and limitations.</p>
<h1><a class="anchor" id="Performance"></a>
Performance</h1>
<p >Here you can see some timings comparing with other notable implementations. The <em>Hit</em> graph shows the time required for searching random objects with a key. The <em>Change</em> graph shows the time required for searching, removing and reinserting random objects with a different key value.</p>
<p >Times are expressed in nanoseconds for each element, and <b>lower is better</b>.</p>
<p >To have some reference numbers, you can check <a href="https://gist.github.com/jboner/2841832">Latency numbers every programmer should know</a>.</p>
<p >A complete analysis is available in the <a class="el" href="benchmark.html">Tommy Benchmarks</a> page.</p>
<p ><img src="def/img_random_hit.png" alt="" class="inline"/></p>
<p ><img src="def/img_random_change.png" alt="" class="inline"/> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</body>
</html>
